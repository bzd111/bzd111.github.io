{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020-05-28-HighPerformancePython/","result":{"data":{"markdownRemark":{"html":"<!-- vim-markdown-toc Redcarpet -->\n<ul>\n<li><a href=\"#list-and-tuple\">List and Tuple</a></li>\n<li><a href=\"#dict\">Dict</a>\n<ul>\n<li><a href=\"#linear-probing\">linear probing</a></li>\n<li><a href=\"#dict-resizing\">Dict Resizing</a></li>\n<li><a href=\"#hashable-type\">Hashable Type</a></li>\n<li><a href=\"#dictionaries-and-namespaces\">Dictionaries and Namespaces</a></li>\n</ul>\n</li>\n<li><a href=\"#iterators-and-generators\">Iterators and Generators</a>\n<ul>\n<li><a href=\"#for-loop\">For loop</a></li>\n<li><a href=\"#itertools\">itertools</a></li>\n</ul>\n</li>\n<li><a href=\"#concurrency\">Concurrency</a></li>\n<li><a href=\"#how-does-async-await-work\">How Does async/await Work?</a>\n<ul>\n<li><a href=\"#i-o-wait\">I/O wait</a></li>\n<li><a href=\"#cralwer\">cralwer</a>\n<ul>\n<li><a href=\"#aiohttp-%3E-tornado-%3E-gevent-%3E-serial\">aiohttp > tornado > gevent > serial</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#the-multiprocessing-module\">The multiprocessing Module</a>\n<ul>\n<li><a href=\"#overview-the-multiprocessing-module\">Overview the multiprocessing module</a></li>\n<li><a href=\"#interprocess-communication\">Interprocess Communication</a>\n<ul>\n<li><a href=\"#manager-value\">Manager.Value</a></li>\n<li><a href=\"#redis\">Redis</a></li>\n<li><a href=\"#multiprocessing-rawvalue\">multiprocessing.RawValue</a></li>\n<li><a href=\"#mmap-mmap\">mmap.mmap</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#clusters-and-job-queues\">Clusters and Job Queues</a>\n<ul>\n<li><a href=\"#benefits\">Benefits</a></li>\n<li><a href=\"#drawbacks\">Drawbacks</a></li>\n<li><a href=\"#nsq\">nsq</a>\n<ul>\n<li><a href=\"#nsqd\">nsqd</a></li>\n<li><a href=\"#nsqadmin\">nsqadmin</a></li>\n<li><a href=\"#nsq_tail\">nsq_tail</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#using-less-ram\">Using Less RAM</a>\n<ul>\n<li><a href=\"#understanding-the-ram-used-in-a-collection\">Understanding the RAM Used in a Collection</a></li>\n<li><a href=\"#bloom-filters\">Bloom Filters</a></li>\n</ul>\n</li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n<!-- vim-markdown-toc -->\n<h1 id=\"list-and-tuple\" style=\"position:relative;\"><a href=\"#list-and-tuple\" aria-label=\"list and tuple permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>List and Tuple</h1>\n<p>list: Lists are dynamic arrays that let us modify and resize the data we are storing,\ntuple: tuples are static arrays whose contents are fixed and immutable.\n同属于 arrays</p>\n<p>Lists are dynamic arrays; they are mutable and allow for resizing (changing the number of elements that are held).</p>\n<p>Tuples are static arrays; they are immutable, and the data within them cannot be changed after they have been created.</p>\n<p>Tuples are cached by the Python runtime, which means that we don’t need to talk to the kernel to reserve memory every time we want to use one.</p>\n<h1 id=\"dict\" style=\"position:relative;\"><a href=\"#dict\" aria-label=\"dict permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dict</h1>\n<h2 id=\"linear-probing\" style=\"position:relative;\"><a href=\"#linear-probing\" aria-label=\"linear probing permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>linear probing</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">def index_sequence(key, mask=0b111, PERTURB_SHIFT=5):\n    perturb = hash(key) 1\n    i = perturb &amp; mask\n    yield i\n    while True:\n        perturb >>= PERTURB_SHIFT\n        i = (i * 5 + perturb + 1) &amp; mask\n        yield i</code></pre></div>\n<h2 id=\"dict-resizing\" style=\"position:relative;\"><a href=\"#dict-resizing\" aria-label=\"dict resizing permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dict Resizing</h2>\n<p>By default, the smallest size of a dictionary or set is 8,it will resize by 3× if the dictionary is more than two-thirds full</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">8; 18; 39; 81; 165; 333; 669; 1,341; 2,685; 5,373; 10,749; 21,501; 43,005;</code></pre></div>\n<h2 id=\"hashable-type\" style=\"position:relative;\"><a href=\"#hashable-type\" aria-label=\"hashable type permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hashable Type</h2>\n<p>__hash__ with __cmp__ or __eq__</p>\n<h2 id=\"dictionaries-and-namespaces\" style=\"position:relative;\"><a href=\"#dictionaries-and-namespaces\" aria-label=\"dictionaries and namespaces permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dictionaries and Namespaces</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">local() -> globals() -> \\_\\_builtin\\_\\_\nList       Dict</code></pre></div>\n<p><a href=\"https://github.com/mynameisfiber/high_performance_python_2e/blob/master/04_dict_set/namespace.py\">Namespaces</a></p>\n<h1 id=\"iterators-and-generators\" style=\"position:relative;\"><a href=\"#iterators-and-generators\" aria-label=\"iterators and generators permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Iterators and Generators</h1>\n<h2 id=\"for-loop\" style=\"position:relative;\"><a href=\"#for-loop\" aria-label=\"for loop permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>For loop</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># The Python loop\nfor i in object:\n    do_work(i)\n\n# Is equivalent to\nobject_iterator = iter(object)\nwhile True:\n    try:\n        i = next(object_iterator)\n    except StopIteration:\n        break\n    else:\n        do_work(i)</code></pre></div>\n<h2 id=\"itertools\" style=\"position:relative;\"><a href=\"#itertools\" aria-label=\"itertools permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>itertools</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">islice\nAllows slicing a potentially infinite generator\n\nchain\nChains together multiple generators\n\ntakewhile\nAdds a condition that will end a generator\n\ncycle\nMakes a finite generator infinite by constantly repeating it</code></pre></div>\n<h1 id=\"concurrency\" style=\"position:relative;\"><a href=\"#concurrency\" aria-label=\"concurrency permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Concurrency</h1>\n<h1 id=\"how-does-asyncawait-work\" style=\"position:relative;\"><a href=\"#how-does-asyncawait-work\" aria-label=\"how does asyncawait work permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How Does async/await Work?</h1>\n<p>await Future object contain a result</p>\n<h2 id=\"io-wait\" style=\"position:relative;\"><a href=\"#io-wait\" aria-label=\"io wait permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>I/O wait</h2>\n<p>hard drive, network adapter, GPU</p>\n<h2 id=\"cralwer\" style=\"position:relative;\"><a href=\"#cralwer\" aria-label=\"cralwer permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>cralwer</h2>\n<h3 id=\"aiohttp--tornado--gevent--serial\" style=\"position:relative;\"><a href=\"#aiohttp--tornado--gevent--serial\" aria-label=\"aiohttp  tornado  gevent  serial permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>aiohttp > tornado > gevent > serial</h3>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Usage</th>\n<th align=\"center\">serial</th>\n<th align=\"center\">gevent</th>\n<th align=\"center\">tornado</th>\n<th align=\"center\">aiohttp</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">Runtime (s)</td>\n<td align=\"center\">102.684</td>\n<td align=\"center\">1.142</td>\n<td align=\"center\">1.171</td>\n<td align=\"center\">1.101</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"the-multiprocessing-module\" style=\"position:relative;\"><a href=\"#the-multiprocessing-module\" aria-label=\"the multiprocessing module permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The multiprocessing Module</h1>\n<h2 id=\"overview-the-multiprocessing-module\" style=\"position:relative;\"><a href=\"#overview-the-multiprocessing-module\" aria-label=\"overview the multiprocessing module permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview the multiprocessing module</h2>\n<p>Process\nA forked copy of the current process; this creates a new process identifier, and the task runs as an independent child process in the operating system. You can start and query the state of the Process and provide it with a target method to run.</p>\n<p>Pool\nWraps the Process or threading.Thread API into a convenient pool of workers that share a chunk of work and return an aggregated result.</p>\n<p>Queue\nA FIFO queue allowing multiple producers and consumers.</p>\n<p>Pipe\nA uni- or bidirectional communication channel between two processes.</p>\n<p>Manager\nA high-level managed interface to share Python objects between processes.</p>\n<p>ctypes\nAllows sharing of primitive datatypes (e.g., integers, floats, and bytes) between processes after they have forked.</p>\n<p>multiprocessing use physical cores</p>\n<h2 id=\"interprocess-communication\" style=\"position:relative;\"><a href=\"#interprocess-communication\" aria-label=\"interprocess communication permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Interprocess Communication</h2>\n<h3 id=\"managervalue\" style=\"position:relative;\"><a href=\"#managervalue\" aria-label=\"managervalue permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Manager.Value</h3>\n<h3 id=\"redis\" style=\"position:relative;\"><a href=\"#redis\" aria-label=\"redis permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Redis</h3>\n<h3 id=\"multiprocessingrawvalue\" style=\"position:relative;\"><a href=\"#multiprocessingrawvalue\" aria-label=\"multiprocessingrawvalue permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>multiprocessing.RawValue</h3>\n<p>behave similarly to array.array</p>\n<h3 id=\"mmapmmap\" style=\"position:relative;\"><a href=\"#mmapmmap\" aria-label=\"mmapmmap permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>mmap.mmap</h3>\n<p>seek\nread_byte\nwrite_byte</p>\n<p>#Clusters and Job Queues</p>\n<h2 id=\"benefits\" style=\"position:relative;\"><a href=\"#benefits\" aria-label=\"benefits permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Benefits</h2>\n<ul>\n<li>easily scale computing requirements</li>\n<li>clusters can be separated geographically</li>\n</ul>\n<h2 id=\"drawbacks\" style=\"position:relative;\"><a href=\"#drawbacks\" aria-label=\"drawbacks permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Drawbacks</h2>\n<ul>\n<li>Maintaining expensive</li>\n</ul>\n<h2 id=\"nsq\" style=\"position:relative;\"><a href=\"#nsq\" aria-label=\"nsq permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nsq</h2>\n<p>produce -> topic -> channels -> consumers</p>\n<h3 id=\"nsqd\" style=\"position:relative;\"><a href=\"#nsqd\" aria-label=\"nsqd permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nsqd</h3>\n<p>start an instance</p>\n<h3 id=\"nsqadmin\" style=\"position:relative;\"><a href=\"#nsqadmin\" aria-label=\"nsqadmin permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nsqadmin</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">curl \"http://127.0.0.1:4151/stats\"</code></pre></div>\n<p>or</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">nsqadmin --lookupd-http-address=127.0.0.1:4161</code></pre></div>\n<h3 id=\"nsq_tail\" style=\"position:relative;\"><a href=\"#nsq_tail\" aria-label=\"nsq_tail permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nsq_tail</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">nsq_tail --topic prime -n 5 --nsqd-tcp-address=127.0.0.1:4150</code></pre></div>\n<h1 id=\"using-less-ram\" style=\"position:relative;\"><a href=\"#using-less-ram\" aria-label=\"using less ram permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using Less RAM</h1>\n<h2 id=\"understanding-the-ram-used-in-a-collection\" style=\"position:relative;\"><a href=\"#understanding-the-ram-used-in-a-collection\" aria-label=\"understanding the ram used in a collection permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Understanding the RAM Used in a Collection</h2>\n<p>int object costs 24 bytes in Python 3.7</p>\n<p>empty byte sequence costs 33 bytes</p>\n<p>An empty list costs 64 bytes, each item in the list takes another 8 bytes on a 64-bit laptop</p>\n<h2 id=\"bloom-filters\" style=\"position:relative;\"><a href=\"#bloom-filters\" aria-label=\"bloom filters permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bloom Filters</h2>\n<p>self.num<em>bits = int((-capacity * math.log(error)) // math.log(2) ** 2 + 1)\nself.num</em>hashes = int((self.num_bits * math.log(2)) // capacity + 1)</p>\n<h1 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h1>\n<ul>\n<li><a href=\"https://learning.oreilly.com/library/view/high-performance-python/9781492055013/\">https://learning.oreilly.com/library/view/high-performance-python/9781492055013/</a></li>\n<li><a href=\"https://github.com/mynameisfiber/high_performance_python\">https://github.com/mynameisfiber/high_performance_python</a></li>\n<li><a href=\"https://github.com/mynameisfiber/high_performance_python_2e\">https://github.com/mynameisfiber/high_performance_python_2e</a></li>\n</ul>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#list-and-tuple\">List and Tuple</a></p>\n</li>\n<li>\n<p><a href=\"#dict\">Dict</a></p>\n<ul>\n<li><a href=\"#linear-probing\">linear probing</a></li>\n<li><a href=\"#dict-resizing\">Dict Resizing</a></li>\n<li><a href=\"#hashable-type\">Hashable Type</a></li>\n<li><a href=\"#dictionaries-and-namespaces\">Dictionaries and Namespaces</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#iterators-and-generators\">Iterators and Generators</a></p>\n<ul>\n<li><a href=\"#for-loop\">For loop</a></li>\n<li><a href=\"#itertools\">itertools</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#concurrency\">Concurrency</a></p>\n</li>\n<li>\n<p><a href=\"#how-does-asyncawait-work\">How Does async/await Work?</a></p>\n<ul>\n<li>\n<p><a href=\"#io-wait\">I/O wait</a></p>\n</li>\n<li>\n<p><a href=\"#cralwer\">cralwer</a></p>\n<ul>\n<li><a href=\"#aiohttp--tornado--gevent--serial\">aiohttp > tornado > gevent > serial</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#the-multiprocessing-module\">The multiprocessing Module</a></p>\n<ul>\n<li>\n<p><a href=\"#overview-the-multiprocessing-module\">Overview the multiprocessing module</a></p>\n</li>\n<li>\n<p><a href=\"#interprocess-communication\">Interprocess Communication</a></p>\n<ul>\n<li><a href=\"#managervalue\">Manager.Value</a></li>\n<li><a href=\"#redis\">Redis</a></li>\n<li><a href=\"#multiprocessingrawvalue\">multiprocessing.RawValue</a></li>\n<li><a href=\"#mmapmmap\">mmap.mmap</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#benefits\">Benefits</a></p>\n</li>\n<li>\n<p><a href=\"#drawbacks\">Drawbacks</a></p>\n</li>\n<li>\n<p><a href=\"#nsq\">nsq</a></p>\n<ul>\n<li><a href=\"#nsqd\">nsqd</a></li>\n<li><a href=\"#nsqadmin\">nsqadmin</a></li>\n<li><a href=\"#nsq_tail\">nsq_tail</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#using-less-ram\">Using Less RAM</a></p>\n<ul>\n<li><a href=\"#understanding-the-ram-used-in-a-collection\">Understanding the RAM Used in a Collection</a></li>\n<li><a href=\"#bloom-filters\">Bloom Filters</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n</ul>","frontmatter":{"title":"[读书笔记]HighPerformancePython2e","date":"2020-05-28"}}},"pageContext":{"slug":"/2020-05-28-HighPerformancePython"}},"staticQueryHashes":["3649515864"],"slicesMap":{}}