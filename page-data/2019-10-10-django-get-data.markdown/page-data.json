{"componentChunkName":"component---src-templates-blog-post-js","path":"/2019-10-10-django-get-data.markdown/","result":{"data":{"markdownRemark":{"html":"<!-- vim-markdown-toc Redcarpet -->\n<ul>\n<li><a href=\"#django\">django</a>\n<ul>\n<li><a href=\"#function-view-%E4%BD%BF%E7%94%A8-get-method\">function view 使用 get method</a>\n<ul>\n<li><a href=\"#%E4%B8%80%E8%88%AC%E9%A3%8E%E6%A0%BC\">一般风格</a></li>\n<li><a href=\"#rest-%E9%A3%8E%E6%A0%BC\">rest 风格</a></li>\n</ul>\n</li>\n<li><a href=\"#class-based-view-%E4%BD%BF%E7%94%A8-get-method\">class-based view 使用 get method</a>\n<ul>\n<li><a href=\"#%E4%B8%80%E8%88%AC%E9%A3%8E%E6%A0%BC\">一般风格</a></li>\n<li><a href=\"#rest-%E9%A3%8E%E6%A0%BC\">rest 风格</a></li>\n</ul>\n</li>\n<li><a href=\"#function-view-%E4%BD%BF%E7%94%A8-post-method\">function view 使用 post method</a></li>\n<li><a href=\"#class-view-%E4%BD%BF%E7%94%A8-post%E3%80%81put-method\">class view 使用 post、put method</a>\n<ul>\n<li><a href=\"#%E5%A4%84%E7%90%86-post-method\">处理 post method</a></li>\n<li><a href=\"#%E5%A4%84%E7%90%86-put-method\">处理 put method</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E6%80%BB%E7%BB%93\">总结</a></li>\n<li><a href=\"#%E6%B3%A8%E6%84%8F%EF%BC%9A\">注意：</a></li>\n</ul>\n<!-- vim-markdown-toc -->\n<h1 id=\"django\" style=\"position:relative;\"><a href=\"#django\" aria-label=\"django permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>django</h1>\n<p>首先根据 view 类型分成两类，function view、class-based view</p>\n<p>再根据 http method 分成两类，get，put post delete</p>\n<p>所以两两分组就会有 4 中情况。其实大同小异。</p>\n<p>这里统一使用 Django REST framework 提供 api 服务</p>\n<h2 id=\"function-view-使用-get-method\" style=\"position:relative;\"><a href=\"#function-view-%E4%BD%BF%E7%94%A8-get-method\" aria-label=\"function view 使用 get method permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>function view 使用 get method</h2>\n<h3 id=\"一般风格\" style=\"position:relative;\"><a href=\"#%E4%B8%80%E8%88%AC%E9%A3%8E%E6%A0%BC\" aria-label=\"一般风格 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>一般风格</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># url</span>\nhttp<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>localhost<span class=\"token punctuation\">:</span><span class=\"token number\">8000</span><span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>test?tags<span class=\"token operator\">=</span><span class=\"token number\">1</span>\n\n<span class=\"token comment\"># urls.py</span>\npath<span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> views<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># views.py</span>\n<span class=\"token comment\"># 需要从request.GET中获取，request.GET的类型是QueryDict</span>\n<span class=\"token decorator annotation punctuation\">@api_view</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> Response<span class=\"token punctuation\">(</span>data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">.</span>GET<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> status<span class=\"token operator\">=</span>HTTP_200_OK<span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"rest-风格\" style=\"position:relative;\"><a href=\"#rest-%E9%A3%8E%E6%A0%BC\" aria-label=\"rest 风格 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>rest 风格</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># url</span>\nhttp<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>localhost<span class=\"token punctuation\">:</span><span class=\"token number\">8000</span><span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>test<span class=\"token operator\">/</span><span class=\"token number\">1</span><span class=\"token operator\">/</span>\n\n<span class=\"token comment\"># urls.py</span>\npath<span class=\"token punctuation\">(</span><span class=\"token string\">'test/&lt;tags>/'</span><span class=\"token punctuation\">,</span> views<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># views.py</span>\n<span class=\"token comment\"># 需要将url中的参数传入到function中</span>\n<span class=\"token decorator annotation punctuation\">@api_view</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> tags<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> Response<span class=\"token punctuation\">(</span>data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">:</span> tags<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> status<span class=\"token operator\">=</span>HTTP_200_OK<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"class-based-view-使用-get-method\" style=\"position:relative;\"><a href=\"#class-based-view-%E4%BD%BF%E7%94%A8-get-method\" aria-label=\"class based view 使用 get method permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>class-based view 使用 get method</h2>\n<h3 id=\"一般风格-1\" style=\"position:relative;\"><a href=\"#%E4%B8%80%E8%88%AC%E9%A3%8E%E6%A0%BC-1\" aria-label=\"一般风格 1 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>一般风格</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># url</span>\nhttp<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>localhost<span class=\"token punctuation\">:</span><span class=\"token number\">8000</span><span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>test?tags<span class=\"token operator\">=</span><span class=\"token number\">1</span>\n\n<span class=\"token comment\"># urls.py</span>\npath<span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span> views<span class=\"token punctuation\">.</span>TestAPIView<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token comment\"># views.py</span>\n<span class=\"token comment\"># 需要从request.GET中获取，request.GET的类型是QueryDict</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TestAPIView</span><span class=\"token punctuation\">(</span>generics<span class=\"token punctuation\">.</span>RetrieveUpdateAPIView<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> Response<span class=\"token punctuation\">(</span>data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">.</span>GET<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        status<span class=\"token operator\">=</span>HTTP_200_OK<span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"rest-风格-1\" style=\"position:relative;\"><a href=\"#rest-%E9%A3%8E%E6%A0%BC-1\" aria-label=\"rest 风格 1 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>rest 风格</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># url</span>\nhttp<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>localhost<span class=\"token punctuation\">:</span><span class=\"token number\">8000</span><span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>test<span class=\"token operator\">/</span><span class=\"token number\">1</span><span class=\"token operator\">/</span>\n\n<span class=\"token comment\"># urls.py</span>\npath<span class=\"token punctuation\">(</span><span class=\"token string\">'test/&lt;tags>/'</span><span class=\"token punctuation\">,</span> views<span class=\"token punctuation\">.</span>TestAPIView<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># views.py</span>\n<span class=\"token comment\"># 需要从kwargs中获取传入的参数</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TestAPIView</span><span class=\"token punctuation\">(</span>generics<span class=\"token punctuation\">.</span>RetrieveUpdateAPIView<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> Response<span class=\"token punctuation\">(</span>data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">:</span> kwargs<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        status<span class=\"token operator\">=</span>HTTP_200_OK<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"function-view-使用-post-method\" style=\"position:relative;\"><a href=\"#function-view-%E4%BD%BF%E7%94%A8-post-method\" aria-label=\"function view 使用 post method permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>function view 使用 post method</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 验证</span>\nhttp <span class=\"token punctuation\">:</span><span class=\"token number\">8000</span><span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>test<span class=\"token operator\">/</span> tags<span class=\"token operator\">=</span><span class=\"token number\">10</span>\n\n<span class=\"token comment\"># urls.py</span>\npath<span class=\"token punctuation\">(</span><span class=\"token string\">'test/'</span><span class=\"token punctuation\">,</span> views<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># views.py</span>\n<span class=\"token comment\"># 需要使用json将byte字符串loads成字典</span>\n<span class=\"token decorator annotation punctuation\">@api_view</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    body <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> Response<span class=\"token punctuation\">(</span>data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">:</span> body<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    status<span class=\"token operator\">=</span>HTTP_200_OK<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"class-view-使用-postput-method\" style=\"position:relative;\"><a href=\"#class-view-%E4%BD%BF%E7%94%A8-postput-method\" aria-label=\"class view 使用 postput method permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>class view 使用 post、put method</h2>\n<h3 id=\"处理-post-method\" style=\"position:relative;\"><a href=\"#%E5%A4%84%E7%90%86-post-method\" aria-label=\"处理 post method permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>处理 post method</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 验证</span>\nhttp <span class=\"token punctuation\">:</span><span class=\"token number\">8000</span><span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>test<span class=\"token operator\">/</span> tags<span class=\"token operator\">=</span><span class=\"token number\">11</span>\n\n<span class=\"token comment\"># urls.py</span>\npath<span class=\"token punctuation\">(</span><span class=\"token string\">'test/'</span><span class=\"token punctuation\">,</span> views<span class=\"token punctuation\">.</span>TestAPIView<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token comment\"># views.py</span>\n<span class=\"token comment\"># 方法和上面相同</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TestAPIView</span><span class=\"token punctuation\">(</span>generics<span class=\"token punctuation\">.</span>CreateAPIView<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">post</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        body <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> Response<span class=\"token punctuation\">(</span>data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">:</span> body<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> status<span class=\"token operator\">=</span>HTTP_200_OK<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h3 id=\"处理-put-method\" style=\"position:relative;\"><a href=\"#%E5%A4%84%E7%90%86-put-method\" aria-label=\"处理 put method permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>处理 put method</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 验证</span>\nhttp PUT <span class=\"token punctuation\">:</span><span class=\"token number\">8000</span><span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>test<span class=\"token operator\">/</span><span class=\"token number\">1</span><span class=\"token operator\">/</span> tags<span class=\"token operator\">=</span><span class=\"token number\">11</span>\n\n<span class=\"token comment\"># urls.py</span>\npath<span class=\"token punctuation\">(</span><span class=\"token string\">'test/&lt;tags>/'</span><span class=\"token punctuation\">,</span> views<span class=\"token punctuation\">.</span>TestAPIView<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># views.py</span>\n<span class=\"token comment\"># 这里需要把put方法单独提出来说一下，因为修改时要带着id，去数据库获取数据去修改</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TestAPIView</span><span class=\"token punctuation\">(</span>generics<span class=\"token punctuation\">.</span>UpdateAPIView<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">put</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        pk <span class=\"token operator\">=</span> kwargs<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># 这个是要修改唯一标识</span>\n        <span class=\"token comment\"># 可以通过kwargs获取到</span>\n        body <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> Response<span class=\"token punctuation\">(</span>data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">:</span> body<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'tags'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> status<span class=\"token operator\">=</span>HTTP_200_OK<span class=\"token punctuation\">)</span></code></pre></div>\n<h1 id=\"总结\" style=\"position:relative;\"><a href=\"#%E6%80%BB%E7%BB%93\" aria-label=\"总结 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>总结</h1>\n<p>function view get method 一般接口需要从 request.GET 获取数据\nrest 风格需要把参数放到 url，并且把参数放到 function 中，</p>\n<p>function view post method，需要从 request.body 中获取数据，</p>\n<p>class view get method，一般接口和上面相同，需要从 request.GET 获取数据\nrest 风格需要从 kwargs 中获取</p>\n<p>class view post method 需要从 request.body 中到数据，如果是 put、delete method，需要传入唯一标识，\n可以从 kwargs 中获取数据，并且要在 url 中声明</p>\n<h1 id=\"注意\" style=\"position:relative;\"><a href=\"#%E6%B3%A8%E6%84%8F\" aria-label=\"注意 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>注意：</h1>\n<p>验证中使用的 http 是<a href=\"https://httpie.org/\">httpie 工具</a></p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#django\">django</a></p>\n<ul>\n<li>\n<p><a href=\"#function-view-%E4%BD%BF%E7%94%A8-get-method\">function view 使用 get method</a></p>\n<ul>\n<li><a href=\"#%E4%B8%80%E8%88%AC%E9%A3%8E%E6%A0%BC\">一般风格</a></li>\n<li><a href=\"#rest-%E9%A3%8E%E6%A0%BC\">rest 风格</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#class-based-view-%E4%BD%BF%E7%94%A8-get-method\">class-based view 使用 get method</a></p>\n<ul>\n<li><a href=\"#%E4%B8%80%E8%88%AC%E9%A3%8E%E6%A0%BC-1\">一般风格</a></li>\n<li><a href=\"#rest-%E9%A3%8E%E6%A0%BC-1\">rest 风格</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#function-view-%E4%BD%BF%E7%94%A8-post-method\">function view 使用 post method</a></p>\n</li>\n<li>\n<p><a href=\"#class-view-%E4%BD%BF%E7%94%A8-postput-method\">class view 使用 post、put method</a></p>\n<ul>\n<li><a href=\"#%E5%A4%84%E7%90%86-post-method\">处理 post method</a></li>\n<li><a href=\"#%E5%A4%84%E7%90%86-put-method\">处理 put method</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E6%80%BB%E7%BB%93\">总结</a></p>\n</li>\n<li>\n<p><a href=\"#%E6%B3%A8%E6%84%8F\">注意：</a></p>\n</li>\n</ul>","frontmatter":{"title":"django获取数据","date":"2019-10-10 20:49:52 +0800"}}},"pageContext":{"slug":"/2019-10-10-django-get-data.markdown"}},"staticQueryHashes":["3649515864"],"slicesMap":{}}