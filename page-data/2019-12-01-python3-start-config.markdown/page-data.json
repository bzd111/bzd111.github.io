{"componentChunkName":"component---src-templates-blog-post-js","path":"/2019-12-01-python3-start-config.markdown/","result":{"data":{"markdownRemark":{"html":"<!-- vim-markdown-toc Redcarpet -->\n<ul>\n<li><a href=\"#%E5%89%8D%E8%A8%80\">前言</a></li>\n<li><a href=\"#%E5%B7%A5%E5%85%B7%E5%92%8C%E5%AE%89%E8%A3%85\">工具和安装</a>\n<ul>\n<li><a href=\"#%E5%B7%A5%E5%85%B7\">工具</a></li>\n<li><a href=\"#%E5%AE%89%E8%A3%85\">安装</a>\n<ul>\n<li><a href=\"#pre-commit\">pre-commit</a>\n<ul>\n<li><a href=\"#%E5%AE%89%E8%A3%85%E9%92%A9%E5%AD%90\">安装钩子</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#demo\">Demo</a></li>\n</ul>\n</li>\n<li><a href=\"#git-commit\">git commit</a></li>\n<li><a href=\"#refenrce\">Refenrce</a></li>\n</ul>\n<!-- vim-markdown-toc -->\n<h1 id=\"前言\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h1>\n<p>为了统一代码风格</p>\n<h1 id=\"工具和安装\" style=\"position:relative;\"><a href=\"#%E5%B7%A5%E5%85%B7%E5%92%8C%E5%AE%89%E8%A3%85\" aria-label=\"工具和安装 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>工具和安装</h1>\n<h2 id=\"工具\" style=\"position:relative;\"><a href=\"#%E5%B7%A5%E5%85%B7\" aria-label=\"工具 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>工具</h2>\n<ul>\n<li><a href=\"https://github.com/git/git\">git</a>: 代码管理</li>\n<li><a href=\"https://github.com/pypa/pipenv\">pipenv</a>: 虚拟环境</li>\n<li><a href=\"https://github.com/PyCQA/flake8\">flake8</a>: 代码风格检测</li>\n<li><a href=\"https://github.com/psf/black\">black</a>: 代码格式化</li>\n<li><a href=\"https://github.com/timothycrosley/isort\">isort</a>: 排序导入</li>\n<li><a href=\"https://docs.pytest.org/en/latest/\">pytest</a>: 单元测试</li>\n<li><a href=\"https://pre-commit.com/\">pre-commit</a>: git hooks\n对这些工具不了解，可以看下对应的链接</li>\n</ul>\n<h2 id=\"安装\" style=\"position:relative;\"><a href=\"#%E5%AE%89%E8%A3%85\" aria-label=\"安装 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>安装</h2>\n<p>用 mac 安装就比较简单，<code class=\"language-text\">brew install git</code>、<code class=\"language-text\">brew install pipenv</code>、<code class=\"language-text\">brew install pre-commit</code></p>\n<p>其他三个可以用 pipenv 安装\n<code class=\"language-text\">pipenv install --dev flake8 isort black</code></p>\n<h3 id=\"pre-commit\" style=\"position:relative;\"><a href=\"#pre-commit\" aria-label=\"pre commit permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pre-commit</h3>\n<p>这里稍微介绍下 pre-commit。\ngit 有一些<a href=\"https://git-scm.com/book/zh/v2/%E8%87%AA%E5%AE%9A%E4%B9%89-Git-Git-%E9%92%A9%E5%AD%90\">hooks</a>，应对于重要操作时触发自定义脚本。\nhooks 总共有分为 3 类，提交工作流钩子、电子邮件工作流钩子和其它钩子。\n具体可以看官方文档。\n工作常用到的有 pre-commit、pre-push、pre-pull。</p>\n<h4 id=\"安装钩子\" style=\"position:relative;\"><a href=\"#%E5%AE%89%E8%A3%85%E9%92%A9%E5%AD%90\" aria-label=\"安装钩子 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>安装钩子</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pre-commit install -t pre-commit\npre-commit install -t pre-push\npre-commit install -t pre-pull</code></pre></div>\n<p>其实初始化一个 git 仓库的时候，就已经预置了这些 hooks，这里的安装只是把它 sample 后缀启用了而已，</p>\n<p>这是启用了 pre-commit 钩子的变化，可以看到重新生成了一个没有后缀的 pre-commit</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">❯ ll .git/hooks\n.rwxr-xr-x  478 zhangcheng 29 11 19:37 applypatch-msg.sample\n.rwxr-xr-x  896 zhangcheng 29 11 19:37 commit-msg.sample\n.rwxr-xr-x 3.3k zhangcheng 29 11 19:37 fsmonitor-watchman.sample\n.rwxr-xr-x  189 zhangcheng 29 11 19:37 post-update.sample\n.rwxr-xr-x  424 zhangcheng 29 11 19:37 pre-applypatch.sample\n.rwxr-xr-x 6.0k zhangcheng 29 11 20:20 pre-commit\n.rwxr-xr-x 1.6k zhangcheng 29 11 19:37 pre-commit.sample\n.rwxr-xr-x 1.3k zhangcheng 29 11 19:37 pre-push.sample\n.rwxr-xr-x 4.9k zhangcheng 29 11 19:37 pre-rebase.sample\n.rwxr-xr-x  544 zhangcheng 29 11 19:37 pre-receive.sample\n.rwxr-xr-x 1.5k zhangcheng 29 11 19:37 prepare-commit-msg.sample\n.rwxr-xr-x 3.6k zhangcheng 29 11 19:37 update.sample</code></pre></div>\n<h2 id=\"demo\" style=\"position:relative;\"><a href=\"#demo\" aria-label=\"demo permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Demo</h2>\n<p>1、创建一个仓库，也可从远程 clone 一个，这里为了演示简单，就直接初始化一个\n<code class=\"language-text\">git init</code></p>\n<p>2、demo 代码</p>\n<p>main.py</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> collections <span class=\"token keyword\">import</span> OrderedDict\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">LRUCache</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> capacity<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>od<span class=\"token punctuation\">:</span> OrderedDict<span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> OrderedDict<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>capacity <span class=\"token operator\">=</span> capacity\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> key <span class=\"token keyword\">in</span> self<span class=\"token punctuation\">.</span>od<span class=\"token punctuation\">:</span>\n            val <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>od<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span>\n            self<span class=\"token punctuation\">.</span>od<span class=\"token punctuation\">.</span>move_to_end<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> val\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">put</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> key <span class=\"token keyword\">in</span> self<span class=\"token punctuation\">.</span>od<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">del</span> self<span class=\"token punctuation\">.</span>od<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span>\n            self<span class=\"token punctuation\">.</span>od<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> value\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>od<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> value\n            <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>od<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> self<span class=\"token punctuation\">.</span>capacity<span class=\"token punctuation\">:</span>\n                self<span class=\"token punctuation\">.</span>od<span class=\"token punctuation\">.</span>popitem<span class=\"token punctuation\">(</span>last<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># last=False FIFO</span></code></pre></div>\n<p>这是一个 LRU 算法的示例代码</p>\n<p>3、测试代码\ntest_lru.py</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> unittest\n\n<span class=\"token keyword\">from</span> main <span class=\"token keyword\">import</span> LRUCache\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TestLRU</span><span class=\"token punctuation\">(</span>unittest<span class=\"token punctuation\">.</span>TestCase<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">test_lru</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n        lru <span class=\"token operator\">=</span> LRUCache<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n        lru<span class=\"token punctuation\">.</span>put<span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        lru<span class=\"token punctuation\">.</span>put<span class=\"token punctuation\">(</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n        lru<span class=\"token punctuation\">.</span>put<span class=\"token punctuation\">(</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n        lru<span class=\"token punctuation\">.</span>put<span class=\"token punctuation\">(</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">assert</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>lru<span class=\"token punctuation\">.</span>od<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'c'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'d'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>4、pre-commit 配置文件\n.pre-commit-config.yaml</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">repos</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">repo</span><span class=\"token punctuation\">:</span> local\n    <span class=\"token key atrule\">hooks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> isort\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> isort\n        <span class=\"token key atrule\">stages</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>commit<span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> system\n        <span class=\"token key atrule\">entry</span><span class=\"token punctuation\">:</span> pipenv run isort\n        <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>python<span class=\"token punctuation\">]</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> black\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> black\n        <span class=\"token key atrule\">stages</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>commit<span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> system\n        <span class=\"token key atrule\">entry</span><span class=\"token punctuation\">:</span> pipenv run black <span class=\"token punctuation\">-</span>S\n        <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>python<span class=\"token punctuation\">]</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> flake8\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> flake8\n        <span class=\"token key atrule\">stages</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>commit<span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> system\n        <span class=\"token key atrule\">entry</span><span class=\"token punctuation\">:</span> pipenv run flake8\n        <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>python<span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">exclude</span><span class=\"token punctuation\">:</span> setup.py\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> mypy\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> mypy\n        <span class=\"token key atrule\">stages</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>commit<span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> system\n        <span class=\"token key atrule\">entry</span><span class=\"token punctuation\">:</span> pipenv run mypy\n        <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>python<span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">pass_filenames</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> pytest\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> pytest\n        <span class=\"token key atrule\">stages</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>commit<span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> system\n        <span class=\"token key atrule\">entry</span><span class=\"token punctuation\">:</span> python <span class=\"token punctuation\">-</span>m pytest <span class=\"token punctuation\">-</span>v tests\n        <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>python<span class=\"token punctuation\">]</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> pytest<span class=\"token punctuation\">-</span>cov\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> pytest\n        <span class=\"token key atrule\">stages</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>push<span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> system\n        <span class=\"token key atrule\">entry</span><span class=\"token punctuation\">:</span> python <span class=\"token punctuation\">-</span>m pytest <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>cov=.\n        <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>python<span class=\"token punctuation\">]</span>\n        <span class=\"token key atrule\">pass_filenames</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></code></pre></div>\n<p>5、setup.cfg\n格式工具的配置</p>\n<div class=\"gatsby-highlight\" data-language=\"ini\"><pre class=\"language-ini\"><code class=\"language-ini\"><span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">isort</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">multi_line_output</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">3</span>\n<span class=\"token key attr-name\">include_trailing_comma</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">True</span>\n<span class=\"token key attr-name\">force_grid_wrap</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">0</span>\n<span class=\"token key attr-name\">use_parentheses</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">True</span>\n<span class=\"token key attr-name\">line_length</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">88</span>\n\n\n<span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">black</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token comment\"># skip-string-normalization=True</span>\n<span class=\"token key attr-name\">S</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">True</span>\n<span class=\"token key attr-name\">line-length</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">88</span>\n<span class=\"token key attr-name\">skip-string-normalization</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">True</span>\n<span class=\"token key attr-name\">include</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">\\.pyi?$</span>\n<span class=\"token key attr-name\">exclude</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">\\.git</span>\n          | \\.hg\n          | \\.mypy_cache\n          | \\.tox\n          | \\.venv\n          | _build\n          | buck-out\n          | build\n          | dist\n\n\n<span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">flake8</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">exclude</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">.git,.env,__pycache__,.eggs</span>\n<span class=\"token key attr-name\">max-line-length</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">88</span>\n<span class=\"token key attr-name\">max-complexity</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">18</span>\n<span class=\"token key attr-name\">select</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">B,C,E,F,W,T4</span>\n<span class=\"token key attr-name\">ignore</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">N801,N802,N803,E252,W503,E133,E203,E203,E266,E501</span>\n\n\n<span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">mypy</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">files</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">*.py, tests</span>\n<span class=\"token key attr-name\">ignore_missing_imports</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">true</span>\n<span class=\"token key attr-name\">check_untyped_defs</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">True</span>\n<span class=\"token key attr-name\">disallow_any_generics</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">True</span>\n<span class=\"token key attr-name\">disallow_untyped_defs</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">True</span>\n<span class=\"token key attr-name\">follow_imports</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">silent</span>\n<span class=\"token key attr-name\">strict_optional</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">True</span>\n<span class=\"token key attr-name\">warn_redundant_casts</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">True</span>\n<span class=\"token key attr-name\">warn_unused_ignores</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">True</span>\n\n<span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">tool:pytest</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">testpaths</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">tests</span></code></pre></div>\n<h1 id=\"git-commit\" style=\"position:relative;\"><a href=\"#git-commit\" aria-label=\"git commit permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>git commit</h1>\n<p>提交时会触发 pre-commit 的钩子，会依次运行 isort、black、flake8、mypy、pytest 命令</p>\n<p>会有展示如下信息</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">❯ git commit\nisort....................................................................Passed\nblack....................................................................Passed\nflake8...................................................................Passed\nmypy.....................................................................Passed\npytest...................................................................Passed</code></pre></div>\n<h1 id=\"refenrce\" style=\"position:relative;\"><a href=\"#refenrce\" aria-label=\"refenrce permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Refenrce</h1>\n<ul>\n<li><a href=\"https://github.com/asvetlov/us-pycon-2019-tutoria://github.com/asvetlov/us-pycon-2019-tutorial\">https://github.com/asvetlov/us-pycon-2019-tutoria://github.com/asvetlov/us-pycon-2019-tutorial</a></li>\n<li><a href=\"https://sourcery.ai/blog/python-best-practices/\">https://sourcery.ai/blog/python-best-practices/</a></li>\n</ul>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E5%89%8D%E8%A8%80\">前言</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%B7%A5%E5%85%B7%E5%92%8C%E5%AE%89%E8%A3%85\">工具和安装</a></p>\n<ul>\n<li>\n<p><a href=\"#%E5%B7%A5%E5%85%B7\">工具</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%AE%89%E8%A3%85\">安装</a></p>\n<ul>\n<li>\n<p><a href=\"#pre-commit\">pre-commit</a></p>\n<ul>\n<li><a href=\"#%E5%AE%89%E8%A3%85%E9%92%A9%E5%AD%90\">安装钩子</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#demo\">Demo</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#git-commit\">git commit</a></p>\n</li>\n<li>\n<p><a href=\"#refenrce\">Refenrce</a></p>\n</li>\n</ul>","frontmatter":{"title":"python工程初始化、标准化","date":"2019-12-01"}}},"pageContext":{"slug":"/2019-12-01-python3-start-config.markdown"}},"staticQueryHashes":["3649515864"],"slicesMap":{}}