{"componentChunkName":"component---src-templates-blog-post-js","path":"/2019-10-17-python3-typing.markdown/","result":{"data":{"markdownRemark":{"html":"<!-- vim-markdown-toc Redcarpet -->\n<ul>\n<li><a href=\"#%E5%89%8D%E8%A8%80\">å‰è¨€</a></li>\n<li><a href=\"#typing\">Typing</a>\n<ul>\n<li><a href=\"#%E7%9B%B4%E6%8E%A5%E5%8F%98%E9%87%8F%E5%8F%AF%E5%AF%B9%E5%BA%94\">ç›´æ¥å˜é‡å¯å¯¹åº”</a></li>\n<li><a href=\"#%E5%85%B6%E4%BB%96%E5%AF%B9%E8%B1%A1\">å…¶ä»–å¯¹è±¡</a></li>\n<li><a href=\"#%E4%B8%BE%E4%B8%AA-%F0%9F%8C%B0\">ä¸¾ä¸ª ğŸŒ°</a>\n<ul>\n<li><a href=\"#%E7%AE%80%E5%8D%95%E4%BE%8B%E5%AD%90\">ç®€å•ä¾‹å­</a>\n<ul>\n<li><a href=\"#typevar-bound\">TypeVar bound</a></li>\n</ul>\n</li>\n<li><a href=\"#callable\">Callable</a></li>\n<li><a href=\"#generator\">Generator</a></li>\n</ul>\n</li>\n<li><a href=\"#classvar\">ClassVar</a></li>\n<li><a href=\"#generics\">Generics</a></li>\n</ul>\n</li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n<!-- vim-markdown-toc -->\n<h1 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h1>\n<p><a href=\"https://www.python.org/dev/peps/pep-0484/\">PEP484</a>ï¼Œå¼•å…¥äº†ç±»å‹æ³¨è§£ï¼Œ<a href=\"https://www.python.org/dev/peps/pep-0526/\">PEP526</a>ï¼Œå¼•å…¥äº†å˜é‡çš„è¯­æ³•æ³¨é‡Š</p>\n<h1 id=\"typing\" style=\"position:relative;\"><a href=\"#typing\" aria-label=\"typing permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Typing</h1>\n<h2 id=\"ç›´æ¥å˜é‡å¯å¯¹åº”\" style=\"position:relative;\"><a href=\"#%E7%9B%B4%E6%8E%A5%E5%8F%98%E9%87%8F%E5%8F%AF%E5%AF%B9%E5%BA%94\" aria-label=\"ç›´æ¥å˜é‡å¯å¯¹åº” permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç›´æ¥å˜é‡å¯å¯¹åº”</h2>\n<p>è¿™äº›å¯¹è±¡å¯ä»¥ç›´æ¥å¯¹åº”ä½¿ç”¨</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Typing ä¸­çš„å¯¹è±¡</th>\n<th align=\"center\">Python å†…å»ºçš„å¯¹è±¡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">Dict</td>\n<td align=\"center\">dict</td>\n</tr>\n<tr>\n<td align=\"center\">List</td>\n<td align=\"center\">list</td>\n</tr>\n<tr>\n<td align=\"center\">Tuple</td>\n<td align=\"center\">tuple</td>\n</tr>\n<tr>\n<td align=\"center\">Set</td>\n<td align=\"center\">set</td>\n</tr>\n<tr>\n<td align=\"center\">Deque</td>\n<td align=\"center\">collections.deque</td>\n</tr>\n<tr>\n<td align=\"center\">NamedTuple</td>\n<td align=\"center\">collections.NamedTuple</td>\n</tr>\n<tr>\n<td align=\"center\">IO</td>\n<td align=\"center\">io.StringIOã€io.BytesIOã€open(__file__)ã€open(__file__, â€˜rbâ€™)</td>\n</tr>\n<tr>\n<td align=\"center\">Pattern</td>\n<td align=\"center\">re.Pattern</td>\n</tr>\n<tr>\n<td align=\"center\">Match</td>\n<td align=\"center\">re.Match</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"å…¶ä»–å¯¹è±¡\" style=\"position:relative;\"><a href=\"#%E5%85%B6%E4%BB%96%E5%AF%B9%E8%B1%A1\" aria-label=\"å…¶ä»–å¯¹è±¡ permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å…¶ä»–å¯¹è±¡</h2>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Typing ä¸­çš„å¯¹è±¡</th>\n<th align=\"center\">è§£é‡Šè¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">Optional</td>\n<td align=\"center\">å¯ä»¥æ˜¯ None</td>\n</tr>\n<tr>\n<td align=\"center\">Sequence</td>\n<td align=\"center\">åºåˆ—</td>\n</tr>\n<tr>\n<td align=\"center\">Iterable</td>\n<td align=\"center\">å¯è¿­ä»£</td>\n</tr>\n<tr>\n<td align=\"center\">Mapping</td>\n<td align=\"center\">ä¼¼å­—å…¸ç±»å‹</td>\n</tr>\n<tr>\n<td align=\"center\">Any</td>\n<td align=\"center\">ä»»æ„å¯¹è±¡</td>\n</tr>\n<tr>\n<td align=\"center\">ClassVar</td>\n<td align=\"center\">ç±»å˜é‡</td>\n</tr>\n<tr>\n<td align=\"center\">Callable</td>\n<td align=\"center\">å¯å›è°ƒ</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"ä¸¾ä¸ª-\" style=\"position:relative;\"><a href=\"#%E4%B8%BE%E4%B8%AA-\" aria-label=\"ä¸¾ä¸ª  permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ä¸¾ä¸ª ğŸŒ°</h2>\n<p>æˆ‘ä»¬ä¸€èˆ¬è°ƒç”¨æˆ–è€…ç”³æ˜æ—¶éƒ½æ˜¯ç”¨()çš„ï¼Œåœ¨ä½¿ç”¨ typing æ¨¡å—æ—¶ï¼Œéƒ½æ˜¯ä½¿ç”¨[]çš„</p>\n<h3 id=\"ç®€å•ä¾‹å­\" style=\"position:relative;\"><a href=\"#%E7%AE%80%E5%8D%95%E4%BE%8B%E5%AD%90\" aria-label=\"ç®€å•ä¾‹å­ permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç®€å•ä¾‹å­</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> x <span class=\"token operator\">+</span> y\n\n\nadd<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\nadd<span class=\"token punctuation\">(</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'y'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># mypy: Argument 1 to \"add\" has incompatible type \"str\"; expected \"int\" (E)</span></code></pre></div>\n<p>è¿™æ—¶å€™å¦‚æœæƒ³è¦ä½¿<code class=\"language-text\">add('x', 'y')</code>ä¹Ÿé€šè¿‡æ£€æŸ¥ï¼Œå¯ä»¥è¿™ä¹ˆä¿®æ”¹</p>\n<p>ä½¿ç”¨<code class=\"language-text\">TypeVar</code>ï¼Œå®šä¹‰æ³›å‹ï¼ŒæŒ‡å®š strã€int</p>\n<p>å¦‚æœä¸æŒ‡å®šç±»å‹ä¼šæç¤º<code class=\"language-text\">mypy: Unsupported left operand type for + (\"T\")</code>çš„é”™è¯¯</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> typing <span class=\"token keyword\">import</span> TypeVar <span class=\"token comment\"># æ–°åŠ çš„è¡Œ</span>\n\nT <span class=\"token operator\">=</span> TypeVar<span class=\"token punctuation\">(</span><span class=\"token string\">'T'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># å®šä¹‰Tç±»å‹ï¼Œæ”¯æŒstrã€int</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> T<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> T<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> T<span class=\"token punctuation\">:</span> <span class=\"token comment\"># ä¿®æ”¹çš„è¡Œ</span>\n    <span class=\"token keyword\">return</span> x <span class=\"token operator\">+</span> y\n\n\nadd<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\nadd<span class=\"token punctuation\">(</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'y'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h4 id=\"typevar-bound\" style=\"position:relative;\"><a href=\"#typevar-bound\" aria-label=\"typevar bound permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TypeVar bound</h4>\n<p>TypeVar æœ‰ä¸€äº›å‚æ•°ï¼Œæ¯”å¦‚ boundï¼Œç”¨æ¥å®šä¹‰ TypeVar çš„ä¸Šé™ï¼Œæ„å‘³ç€ TypeVar ç»‘å®šçš„å˜é‡ä¸€å®šæ˜¯ bound<Type>çš„ç±»æˆ–è€…å­ç±»</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> typing <span class=\"token keyword\">import</span> TypeVar\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Shape</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">:</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>width <span class=\"token operator\">=</span> width\n        self<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> height\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">area</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token number\">0</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Rectangle</span><span class=\"token punctuation\">(</span>Shape<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">area</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">:</span>\n        width<span class=\"token punctuation\">:</span> <span class=\"token builtin\">float</span> <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>width\n        height<span class=\"token punctuation\">:</span> <span class=\"token builtin\">float</span> <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>height\n        <span class=\"token keyword\">return</span> width <span class=\"token operator\">*</span> height\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Triangle</span><span class=\"token punctuation\">(</span>Shape<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">area</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">:</span>\n        width<span class=\"token punctuation\">:</span> <span class=\"token builtin\">float</span> <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>width\n        height<span class=\"token punctuation\">:</span> <span class=\"token builtin\">float</span> <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>height\n        <span class=\"token keyword\">return</span> width <span class=\"token operator\">*</span> height <span class=\"token operator\">/</span> <span class=\"token number\">2</span>\n\n\nS <span class=\"token operator\">=</span> TypeVar<span class=\"token punctuation\">(</span><span class=\"token string\">\"S\"</span><span class=\"token punctuation\">,</span> bound<span class=\"token operator\">=</span>Shape<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">area</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">:</span> S<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> s<span class=\"token punctuation\">.</span>area<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\nr<span class=\"token punctuation\">:</span> Rectangle <span class=\"token operator\">=</span> Rectangle<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\nt<span class=\"token punctuation\">:</span> Triangle <span class=\"token operator\">=</span> Triangle<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\ni<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">5566</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>area<span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>area<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># print(area(i))</span>\n<span class=\"token comment\"># Value of type variable \"S\" of \"area\" cannot be \"int\" (E)</span></code></pre></div>\n<h3 id=\"callable\" style=\"position:relative;\"><a href=\"#callable\" aria-label=\"callable permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Callable</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">gcd</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># æœ€å¤§å…¬çº¦æ•°</span>\n    <span class=\"token keyword\">while</span> b<span class=\"token punctuation\">:</span>\n        a<span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> b<span class=\"token punctuation\">,</span> a <span class=\"token operator\">%</span> b\n    <span class=\"token keyword\">return</span> a\n\n\n<span class=\"token comment\"># Callable[[arg, ...], result]</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">fun</span><span class=\"token punctuation\">(</span>cb<span class=\"token punctuation\">:</span> Callable<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> cb<span class=\"token punctuation\">(</span><span class=\"token number\">55</span><span class=\"token punctuation\">,</span> <span class=\"token number\">66</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"generator\" style=\"position:relative;\"><a href=\"#generator\" aria-label=\"generator permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Generator</h3>\n<p>ä¼ å…¥çš„å‚æ•°æœ‰ 3 ä¸ªï¼ŒYieldTypeã€ SendTypeã€ ReturnType\næ­£å¥½å¯¹åº” yield valueã€value = yieldã€return value</p>\n<p>è¿™é‡Œå°±ä¸ä¸¾ä¾‹ YieldType çš„ä¾‹å­äº†ï¼Œå› ä¸ºä¹Ÿæ¯”è¾ƒå¸¸è§\nè¿™é‡Œè¯´ä¸€ä¸‹ï¼ŒSendType å’Œ ReturnType ç»“åˆçš„ä¾‹å­</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> typing <span class=\"token keyword\">import</span> Generator<span class=\"token punctuation\">,</span> Optional<span class=\"token punctuation\">,</span> Union\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">average</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> Generator<span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> Optional<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n    total <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    count <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    avg <span class=\"token operator\">=</span> <span class=\"token number\">0.0</span>\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n        val <span class=\"token operator\">=</span> <span class=\"token keyword\">yield</span>\n        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> val<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">break</span>\n        total <span class=\"token operator\">+=</span> val\n        count <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        avg <span class=\"token operator\">=</span> total <span class=\"token operator\">/</span> count\n    <span class=\"token keyword\">return</span> avg\n\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    result <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    g <span class=\"token operator\">=</span> average<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    g<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># or next(g)</span>\n    g<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n    g<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        g<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span> StopIteration <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n        result <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>value\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'result: '</span><span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">)</span></code></pre></div>\n<p>çœ‹å®Œä»£ç ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œç”¨åˆ°äº†<code class=\"language-text\">Generator Optional</code> æ¥ä¸‹æ¥ä¸€ä¸€è¯´æ˜ä¸‹ï¼Œ</p>\n<ul>\n<li>\n<p>Generator è¯´æ˜ average ç±»å‹æ˜¯ç”Ÿæˆå™¨ï¼Œ</p>\n</li>\n<li>\n<p>SendType æ˜¯ Option[int]ï¼Œå› ä¸ºå¯åŠ¨ç”Ÿæˆå™¨çš„æ—¶å€™è¦å‘é€ä¸€ä¸ª Noneï¼Œè·³å‡º average ä¸­çš„ While Trueï¼Œä¹Ÿéœ€è¦ send ä¸€ä¸ª Noneï¼Œæ‰€ä»¥ç”¨äº† Optional[int]ï¼Œå½“ç„¶å¯ä»¥ç”¨ Union[None, int]</p>\n</li>\n</ul>\n<p><strong>æ³¨æ„: Optional[int] == Union[None, int]</strong></p>\n<h2 id=\"classvar\" style=\"position:relative;\"><a href=\"#classvar\" aria-label=\"classvar permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ClassVar</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> typing <span class=\"token keyword\">import</span> ClassVar<span class=\"token punctuation\">,</span> Dict\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Starship</span><span class=\"token punctuation\">:</span>\n    stats<span class=\"token punctuation\">:</span> ClassVar<span class=\"token punctuation\">[</span>Dict<span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    damage<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n\n\nenterprise_d <span class=\"token operator\">=</span> Starship<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nenterprise_d<span class=\"token punctuation\">.</span>stats <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token comment\"># Cannot assign to class variable \"stats\" via instance</span>\nStarship<span class=\"token punctuation\">.</span>stats <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">Classvar</code>è¡¨ç¤ºæ˜¯ç±»å˜é‡ï¼Œæ‰€ä»¥å½“å®ä¾‹å¯¹ç±»å˜é‡è¿›è¡Œèµ‹å€¼çš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç°ä¸Šé¢é‚£ä¸ªè­¦å‘Š</p>\n<h2 id=\"generics\" style=\"position:relative;\"><a href=\"#generics\" aria-label=\"generics permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Generics</h2>\n<p><code class=\"language-text\">Generics</code>ä¸€èˆ¬éƒ½æ˜¯å’Œ<code class=\"language-text\">TypeVar</code>è”åˆä½¿ç”¨çš„ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> typing <span class=\"token keyword\">import</span> Generic<span class=\"token punctuation\">,</span> List<span class=\"token punctuation\">,</span> TypeVar\n\nT <span class=\"token operator\">=</span> TypeVar<span class=\"token punctuation\">(</span><span class=\"token string\">'T'</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Stack</span><span class=\"token punctuation\">(</span>Generic<span class=\"token punctuation\">[</span>T<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># Create an empty list with items of type T</span>\n        self<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">:</span> List<span class=\"token punctuation\">[</span>T<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">push</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">:</span> T<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">pop</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> T<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">empty</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">bool</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">not</span> self<span class=\"token punctuation\">.</span>items\n\ns1<span class=\"token punctuation\">:</span> Stack<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> Stack<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ns1<span class=\"token punctuation\">.</span>push<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\ns1<span class=\"token punctuation\">.</span>push<span class=\"token punctuation\">(</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Argument 1 to \"push\" of \"Stack\" has incompatible type \"str\"; expected \"int\"</span></code></pre></div>\n<p>è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ª Stack ç±»ï¼Œåªèƒ½å­˜åŒä¸€ç±»å‹çš„å€¼ï¼Œè¿™ä¸ªç±»å‹ç”±å®šä¹‰å®ä¾‹æ—¶ï¼ŒæŒ‡å®šçš„ç±»å‹ã€‚</p>\n<h1 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h1>\n<ul>\n<li><a href=\"https://docs.python.org/3/library/typing.html\">https://docs.python.org/3/library/typing.html</a></li>\n<li><a href=\"https://www.pythonsheets.com/notes/python-typing.html\">https://www.pythonsheets.com/notes/python-typing.html</a></li>\n<li><a href=\"https://mypy.readthedocs.io/en/latest/\">https://mypy.readthedocs.io/en/latest/</a></li>\n</ul>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E5%89%8D%E8%A8%80\">å‰è¨€</a></p>\n</li>\n<li>\n<p><a href=\"#typing\">Typing</a></p>\n<ul>\n<li>\n<p><a href=\"#%E7%9B%B4%E6%8E%A5%E5%8F%98%E9%87%8F%E5%8F%AF%E5%AF%B9%E5%BA%94\">ç›´æ¥å˜é‡å¯å¯¹åº”</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%85%B6%E4%BB%96%E5%AF%B9%E8%B1%A1\">å…¶ä»–å¯¹è±¡</a></p>\n</li>\n<li>\n<p><a href=\"#%E4%B8%BE%E4%B8%AA-\">ä¸¾ä¸ª ğŸŒ°</a></p>\n<ul>\n<li>\n<p><a href=\"#%E7%AE%80%E5%8D%95%E4%BE%8B%E5%AD%90\">ç®€å•ä¾‹å­</a></p>\n<ul>\n<li><a href=\"#typevar-bound\">TypeVar bound</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#callable\">Callable</a></p>\n</li>\n<li>\n<p><a href=\"#generator\">Generator</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#classvar\">ClassVar</a></p>\n</li>\n<li>\n<p><a href=\"#generics\">Generics</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n</ul>","frontmatter":{"title":"python3 typingä½¿ç”¨","date":"2019-10-17"}}},"pageContext":{"slug":"/2019-10-17-python3-typing.markdown"}},"staticQueryHashes":["3649515864"],"slicesMap":{}}