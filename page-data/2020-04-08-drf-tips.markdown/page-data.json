{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020-04-08-drf-tips.markdown/","result":{"data":{"markdownRemark":{"html":"<!-- vim-markdown-toc Redcarpet -->\n<ul>\n<li><a href=\"#%E5%89%8D%E8%A8%80\">前言</a>\n<ul>\n<li><a href=\"#drf-serializers-datetimefield-%E5%AD%97%E6%AE%B5%E8%AE%BE%E7%BD%AE%E6%97%B6%E5%8C%BA%E5%92%8C%E5%B1%95%E7%A4%BA%E5%BD%A2%E5%BC%8F\">drf serializers.DateTimeField 字段设置时区和展示形式</a></li>\n<li><a href=\"#%E8%8E%B7%E5%8F%96%E7%9B%B8%E5%AF%B9%E6%97%B6%E9%97%B4\">获取相对时间</a></li>\n<li><a href=\"#%E8%B0%83%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4%E8%A1%8C\">调用自定义命令行</a></li>\n</ul>\n</li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>\n<!-- vim-markdown-toc -->\n<h1 id=\"前言\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h1>\n<h2 id=\"drf-serializersdatetimefield-字段设置时区和展示形式\" style=\"position:relative;\"><a href=\"#drf-serializersdatetimefield-%E5%AD%97%E6%AE%B5%E8%AE%BE%E7%BD%AE%E6%97%B6%E5%8C%BA%E5%92%8C%E5%B1%95%E7%A4%BA%E5%BD%A2%E5%BC%8F\" aria-label=\"drf serializersdatetimefield 字段设置时区和展示形式 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>drf serializers.DateTimeField 字段设置时区和展示形式</h2>\n<p>serializers.DateTimeField 总共有 3 个参数，</p>\n<p>format,input_formats,default_timezone</p>\n<p>分别表示格式化的样式，输入格式化的样式，默认时区。</p>\n<p>其中 format 比较好理解，一般可以设置为<code class=\"language-text\">%Y-%m-%d %H:%M:%S</code></p>\n<p>default_timezone 是一个 pytz.timezone 对象</p>\n<div class=\"gatsby-highlight\" data-language=\"python3\"><pre class=\"language-python3\"><code class=\"language-python3\">import pytz\nfrom rest_framework import serializers\n\nstart_time = serializers.DateTimeField(\n        format=&#39;%Y-%m-%d %H:%M:%S&#39;, default_timezone=pytz.timezone(&#39;Asia/Shanghai&#39;)\n    )\n</code></pre></div>\n<p>提一嘴，format 是在 to_representation 使用的，input_formats 是在 to_internal_value 时使用</p>\n<h2 id=\"获取相对时间\" style=\"position:relative;\"><a href=\"#%E8%8E%B7%E5%8F%96%E7%9B%B8%E5%AF%B9%E6%97%B6%E9%97%B4\" aria-label=\"获取相对时间 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>获取相对时间</h2>\n<p>在 web 开发中，经常会需要获取当天的数据</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">from datetime import datetime\nfrom datetime import time\nfrom datetime import timedelta\n\nfrom django.utils import timezone\nfrom django.utils.timezone import make_aware\n\n\ntoday = timezone.now()\ntomorrow = today + timedelta(1)\ntoday_start = make_aware(datetime.combine(today, time()))\ntoday_end = make_aware(datetime.combine(tomorrow, time()))</code></pre></div>\n<h2 id=\"调用自定义命令行\" style=\"position:relative;\"><a href=\"#%E8%B0%83%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4%E8%A1%8C\" aria-label=\"调用自定义命令行 permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>调用自定义命令行</h2>\n<p>除了使用命令行调用，还可以使用函数去调用</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">from django.core.management import call_command\n\n\ncall_command(\"command_name\", )</code></pre></div>\n<h1 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h1>\n<ul>\n<li><a href=\"https://books.agiliq.com/projects/django-orm-cookbook/en/latest/\">https://books.agiliq.com/projects/django-orm-cookbook/en/latest/</a></li>\n<li><a href=\"https://books.agiliq.com/projects/django-api-polls-tutorial/en/latest/\">https://books.agiliq.com/projects/django-api-polls-tutorial/en/latest/</a></li>\n<li><a href=\"https://books.agiliq.com/projects/django-admin-cookbook/en/latest/\">https://books.agiliq.com/projects/django-admin-cookbook/en/latest/</a></li>\n<li><a href=\"https://books.agiliq.com/projects/django-multi-tenant/en/latest/\">https://books.agiliq.com/projects/django-multi-tenant/en/latest/</a></li>\n<li><a href=\"https://blog.ansheng.me/article/django-model-qa\">https://blog.ansheng.me/article/django-model-qa</a></li>\n</ul>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E5%89%8D%E8%A8%80\">前言</a></p>\n<ul>\n<li><a href=\"#drf-serializersdatetimefield-%E5%AD%97%E6%AE%B5%E8%AE%BE%E7%BD%AE%E6%97%B6%E5%8C%BA%E5%92%8C%E5%B1%95%E7%A4%BA%E5%BD%A2%E5%BC%8F\">drf serializers.DateTimeField 字段设置时区和展示形式</a></li>\n<li><a href=\"#%E8%8E%B7%E5%8F%96%E7%9B%B8%E5%AF%B9%E6%97%B6%E9%97%B4\">获取相对时间</a></li>\n<li><a href=\"#%E8%B0%83%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4%E8%A1%8C\">调用自定义命令行</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n</ul>","frontmatter":{"title":"[持续更新]drf tips","date":"2020-04-08"}}},"pageContext":{"slug":"/2020-04-08-drf-tips.markdown"}},"staticQueryHashes":["3649515864"],"slicesMap":{}}